# API 设置界面重新设计方案

## 📋 当前问题
1. 排版混乱，信息分散
2. 调整参数后需要点击保存才能保存
3. 编辑已保存配置时看不到参数
4. 保存逻辑不清晰（"存储此配置" vs "保存"）

---

## 🎨 新设计方案

### 整体布局结构

```
┌─────────────────────────────────────┐
│  ← API 配置                          │
├─────────────────────────────────────┤
│                                     │
│  【当前使用的配置】                  │
│  ┌─────────────────────────────┐   │
│  │ ✓ Gemini Pro                │   │
│  │   gpt-4-turbo               │   │
│  │   [编辑] [高级参数]          │   │
│  └─────────────────────────────┘   │
│                                     │
│  【我的配置列表】                    │
│  ┌─────────────────────────────┐   │
│  │ ○ Claude 3.5                │   │
│  │   claude-3-5-sonnet         │   │
│  │   [使用] [编辑] [删除]       │   │
│  └─────────────────────────────┘   │
│  ┌─────────────────────────────┐   │
│  │ ○ GPT-4                    │   │
│  │   gpt-4-turbo              │   │
│  │   [使用] [编辑] [删除]       │   │
│  └─────────────────────────────┘   │
│                                     │
│  [+ 添加新配置]                     │
│                                     │
└─────────────────────────────────────┘
```

---

## 🔧 详细设计

### 1. 顶部：当前使用的配置（卡片式）

```
┌─────────────────────────────────────────┐
│ 🤖 当前使用的配置                        │
├─────────────────────────────────────────┤
│ ✓ Gemini Pro                            │
│                                         │
│ 接口类型：OpenAI 兼容                    │
│ Base URL：https://api.openai.com       │
│ API Key：sk-***...***                   │
│ 模型：gpt-4-turbo                       │
│                                         │
│ [编辑配置] [查看高级参数]                │
└─────────────────────────────────────────┘
```

**特点：**
- 清晰显示当前使用的配置
- 点击"编辑配置"可以修改
- 点击"查看高级参数"展开显示所有参数（温度、Top P等）

---

### 2. 配置列表（简化版）

```
┌─────────────────────────────────────────┐
│ 📋 我的配置列表                          │
├─────────────────────────────────────────┤
│                                         │
│ ○ Claude 3.5                            │
│   claude-3-5-sonnet                     │
│   [使用] [编辑] [删除]                   │
│                                         │
│ ○ GPT-4                                 │
│   gpt-4-turbo                           │
│   [使用] [编辑] [删除]                   │
│                                         │
│ [+ 添加新配置]                           │
│                                         │
└─────────────────────────────────────────┘
```

**特点：**
- 每个配置只显示：名称、模型、操作按钮
- 当前使用的配置用 ✓ 标记，其他用 ○
- 点击"使用"立即切换并保存

---

### 3. 添加/编辑配置（弹窗或展开）

#### 方案A：弹窗式（推荐）

```
┌─────────────────────────────────────────┐
│ 编辑 API 配置                    [×]    │
├─────────────────────────────────────────┤
│                                         │
│ 配置名称 *                               │
│ [Gemini Pro________________]            │
│                                         │
│ 接口类型 *                               │
│ [OpenAI 兼容 ▼]                          │
│                                         │
│ API Base URL *                           │
│ [https://api.openai.com___]             │
│                                         │
│ API Key *                                │
│ [sk-***...***] [👁️]                    │
│                                         │
│ [获取模型列表]                           │
│                                         │
│ 选择模型 *                                │
│ [gpt-4-turbo ▼]                          │
│                                         │
│ ─────────────────────────────────────  │
│ ⚙️ 高级参数（点击展开）                  │
│ ─────────────────────────────────────  │
│                                         │
│ 温度：0.80  [━━━━━━━━━━━━━━━━━━━━]      │
│ Top P：0.95  [━━━━━━━━━━━━━━━━━━━━]    │
│ 最大回复长度：1000  [━━━━━━━━━━━━━━━━]  │
│ 频率惩罚：0.0  [━━━━━━━━━━━━━━━━━━━━]  │
│ 存在惩罚：0.0  [━━━━━━━━━━━━━━━━━━━━]  │
│                                         │
│ [重置为默认]                             │
│                                         │
│ ─────────────────────────────────────  │
│                                         │
│ [取消]  [保存配置]                       │
│                                         │
└─────────────────────────────────────────┘
```

**特点：**
- 所有字段在一个弹窗里，逻辑清晰
- 高级参数默认折叠，点击展开
- 参数调整后实时显示数值
- 保存时一起保存所有内容（包括高级参数）

---

#### 方案B：展开式（备选）

在主界面直接展开编辑区域，不弹窗。

---

## ✨ 核心改进点

### 1. 参数实时显示
- 调整滑块时，数值实时更新
- 不需要点击保存就能看到效果

### 2. 编辑时显示所有参数
- 打开编辑弹窗时，自动加载并显示所有高级参数
- 参数值从 localStorage 读取

### 3. 保存逻辑统一
- 只有一个"保存配置"按钮
- 保存时同时保存：基础配置 + 高级参数
- 保存成功后提示"✓ 已保存"

### 4. 当前配置突出显示
- 顶部单独显示当前使用的配置
- 列表中用 ✓ 标记当前配置

### 5. 操作流程优化
```
添加配置：
1. 点击 [+ 添加新配置]
2. 填写信息 → 调整参数（可选）
3. 点击 [保存配置] → 自动使用新配置

编辑配置：
1. 点击 [编辑]
2. 修改信息 → 调整参数（可选）
3. 点击 [保存配置] → 如果正在使用，自动更新

切换配置：
1. 点击 [使用] → 立即切换并保存
```

---

## 🎯 技术实现要点

1. **参数加载**：编辑时从 `localStorage` 读取高级参数
2. **实时更新**：滑块 onChange 时更新 state，立即显示
3. **统一保存**：保存时同时保存基础配置和高级参数
4. **状态同步**：保存后立即更新全局配置和列表

---

## 📱 移动端适配

- 弹窗宽度：`max-w-[420px]`，移动端全屏
- 滑块：触摸友好，数值显示清晰
- 按钮：足够大的点击区域

---

## 💡 用户体验提升

1. **减少操作步骤**：参数调整后不需要单独保存
2. **信息透明**：编辑时能看到所有参数
3. **操作明确**：每个按钮的作用清晰
4. **即时反馈**：保存后立即显示成功提示
